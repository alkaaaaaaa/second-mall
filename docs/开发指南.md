# 电商项目开发指南

## 项目概述

这是一个基于 Next.js 和 Spring Boot 的全栈电商平台，采用前后端分离架构。

### 技术栈

**前端:**
- Next.js 14 (React 18 + TypeScript)
- Tailwind CSS (样式框架)
- Zustand (状态管理)
- Axios (HTTP客户端)
- React Query (数据获取和缓存)

**后端:**
- Spring Boot 3.2.1
- MyBatis Plus 3.5.5 (ORM框架)
- Spring Security + JWT (认证授权)
- MySQL 8.0 (数据库)
- Redis (缓存)
- Maven (依赖管理)

## 环境要求

### 前端环境
- Node.js 18+ 
- npm 或 yarn

### 后端环境
- JDK 17+
- Maven 3.6+
- MySQL 8.0+
- Redis 5.0+

## 项目结构

```
second-mall/
├── frontend/          # Next.js前端项目
│   ├── src/
│   │   ├── app/       # Next.js App Router页面
│   │   ├── components/# React组件
│   │   ├── stores/    # Zustand状态管理
│   │   ├── types/     # TypeScript类型定义
│   │   ├── utils/     # 工具函数
│   │   ├── lib/       # 库文件(API客户端等)
│   │   └── hooks/     # 自定义Hooks
│   ├── public/        # 静态资源
│   └── package.json   # 依赖配置
├── backend/           # Spring Boot后端项目
│   ├── src/main/java/com/example/ecommerce/
│   │   ├── config/    # 配置类
│   │   ├── controller/# REST控制器
│   │   ├── service/   # 业务逻辑层
│   │   ├── mapper/    # MyBatis Mapper
│   │   ├── entity/    # 数据库实体
│   │   ├── dto/       # 数据传输对象
│   │   ├── common/    # 公共类
│   │   ├── security/  # 安全相关
│   │   └── utils/     # 工具类
│   ├── src/main/resources/
│   │   ├── application.yml # 配置文件
│   │   └── schema.sql      # 数据库脚本
│   └── pom.xml        # Maven配置
├── docs/              # 项目文档
└── README.md          # 项目说明
```

## 快速开始

### 1. 环境准备

#### 安装数据库
```bash
# MySQL (macOS)
brew install mysql
brew services start mysql

# Redis (macOS)  
brew install redis
brew services start redis
```

#### 创建数据库
```sql
mysql -u root -p
source backend/src/main/resources/schema.sql
```

### 2. 后端启动

```bash
# 进入后端目录
cd backend

# 编译项目
mvn clean compile

# 运行项目
mvn spring-boot:run
```

后端服务将在 `http://localhost:8080` 启动

### 3. 前端启动

```bash
# 进入前端目录
cd frontend

# 安装依赖
npm install

# 启动开发服务器
npm run dev
```

前端服务将在 `http://localhost:3000` 启动

## 开发指南

### 前端开发

#### 项目配置

**环境变量配置** (`.env.local`)
```env
NEXT_PUBLIC_API_URL=http://localhost:8080/api
```

#### 状态管理

使用 Zustand 进行状态管理：

```typescript
// 使用认证状态
import { useAuthStore } from '@/stores/authStore';

const { user, isAuthenticated, login, logout } = useAuthStore();
```

#### API调用

使用配置好的API客户端：

```typescript
import { apiClient } from '@/lib/api';

// GET请求
const response = await apiClient.get<Product[]>('/products');

// POST请求
const response = await apiClient.post<User>('/auth/login', { username, password });
```

#### 样式系统

项目使用 Tailwind CSS，推荐使用：

```tsx
import { cn } from '@/utils';

<div className={cn(
  'base-styles',
  condition && 'conditional-styles'
)}>
  内容
</div>
```

### 后端开发

#### 配置文件

主配置文件位于 `src/main/resources/application.yml`，包含：
- 数据库连接配置
- Redis配置
- JWT配置
- 跨域配置

#### MyBatis Plus使用

**实体类示例:**
```java
@Data
@TableName("user")
public class User {
    @TableId(type = IdType.ASSIGN_ID)
    private Long id;
    
    private String username;
    private String email;
    
    @TableLogic
    private Integer deleted;
    
    @TableField(fill = FieldFill.INSERT)
    private LocalDateTime createTime;
    
    @TableField(fill = FieldFill.INSERT_UPDATE)
    private LocalDateTime updateTime;
}
```

**Mapper接口:**
```java
@Mapper
public interface UserMapper extends BaseMapper<User> {
    // 自定义查询方法
}
```

**Service层:**
```java
@Service
public class UserService extends ServiceImpl<UserMapper, User> {
    // 业务逻辑
}
```

#### 接口开发规范

**统一响应格式:**
```java
@Data
public class Result<T> {
    private Integer code;
    private String message;
    private T data;
    
    public static <T> Result<T> success(T data) {
        Result<T> result = new Result<>();
        result.setCode(200);
        result.setMessage("success");
        result.setData(data);
        return result;
    }
}
```

**控制器示例:**
```java
@RestController
@RequestMapping("/api/products")
public class ProductController {
    
    @Autowired
    private ProductService productService;
    
    @GetMapping
    public Result<Page<Product>> getProducts(
            @RequestParam(defaultValue = "1") Integer page,
            @RequestParam(defaultValue = "10") Integer size) {
        Page<Product> products = productService.getProducts(page, size);
        return Result.success(products);
    }
}
```

## 数据库设计

### 核心表结构

- **user**: 用户表
- **category**: 商品分类表  
- **product**: 商品表
- **product_image**: 商品图片表
- **cart**: 购物车表
- **user_address**: 用户地址表
- **orders**: 订单表
- **order_item**: 订单项表
- **payment**: 支付记录表

详细的表结构请参考 `backend/src/main/resources/schema.sql`

## 部署指南

### 前端部署 (Vercel)

1. 将代码推送到 GitHub
2. 在 Vercel 中导入项目
3. 配置环境变量
4. 自动部署

### 后端部署

#### 打包应用
```bash
mvn clean package -DskipTests
```

#### Docker部署
```dockerfile
FROM openjdk:17-jdk-slim
COPY target/ecommerce-backend-0.0.1-SNAPSHOT.jar app.jar
EXPOSE 8080
ENTRYPOINT ["java", "-jar", "/app.jar"]
```

## 注意事项

1. **安全性**: 
   - JWT密钥需要在生产环境中使用强密钥
   - 数据库密码不要硬编码
   - 实施适当的权限控制

2. **性能优化**:
   - 使用Redis缓存热点数据
   - 数据库查询优化
   - 前端代码分割和懒加载

3. **开发规范**:
   - 遵循RESTful API设计原则
   - 使用统一的代码格式
   - 编写单元测试

## 常见问题

### Q: 数据库连接失败？
A: 检查MySQL服务是否启动，配置文件中的数据库连接信息是否正确。

### Q: 前端API调用失败？
A: 检查后端服务是否启动，CORS配置是否正确。

### Q: JWT认证失败？
A: 检查JWT密钥配置，token是否正确传递。

## 下一步开发计划

1. 实现用户认证功能 
2. 完成商品管理模块
3. 开发购物车功能
4. 实现订单管理
5. 集成支付功能
6. 添加搜索功能
7. 实现管理后台

## 联系方式

如有问题，请通过以下方式联系：
- 项目Issues
- 邮箱: your-email@example.com 